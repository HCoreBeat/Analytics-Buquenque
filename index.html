<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Datos</title>

    <!-- Favicon de ejemplo -->
    <link rel="icon" href="https://placehold.co/32x32/4A90E2/FFFFFF?text=B" type="image/png">

    <!-- CSS Modularizado -->
    <link rel="stylesheet" href="Css/main.css">
    <link rel="stylesheet" href="Css/pedidos-new.css">
    <link rel="stylesheet" href="Css/settings.css">
    <link rel="stylesheet" href="Css/modal-github.css">
    <link rel="stylesheet" href="Css/inventory.css">
    <link rel="stylesheet" href="Css/notifications-editor.css">
    <link rel="stylesheet" href="Css/notifications.css">
    <link rel="stylesheet" href="Css/globe.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
        <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.154.0/build/three.module.js"
            }
        }
        </script>
</head>
<body>
    <header class="app-header">
        <div class="header-content">
            <button class="hamburger-menu" id="hamburger-btn" aria-label="Men√∫">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="app-logo">
                <i class="fas fa-chart-line"></i>
                <h1>Buquenque Dashboard</h1>
            </div>
            <span class="header-status"><i class="fas fa-circle status-indicator"></i> Conectado</span>
        </div>
    </header>

    <!-- Overlay para cerrar men√∫ (mobile) -->
    <div class="menu-overlay" id="menu-overlay"></div>

    <div class="main-wrapper">
        <!-- Men√∫ Lateral -->
        <nav class="sidebar-menu" id="sidebar-menu">
            <div class="menu-header">
                <h2><i class="fas fa-bars" style="margin-right: 0.4rem;"></i>Nav</h2>
                <button class="close-menu" id="close-menu" aria-label="Cerrar men√∫">&times;</button>
            </div>
            <ul class="menu-list">
                <li><a href="#" class="menu-item active" data-view="dashboard"><i class="fas fa-home"></i> Dashboard</a></li>
                <li><a href="#" class="menu-item" data-view="pedidos"><i class="fas fa-shopping-cart"></i> Pedidos <span class="pedidos-badge" id="pedidos-menu-badge" style="display: none;"></span></a></li>
                <li><a href="#" class="menu-item" data-view="inventory"><i class="fas fa-boxes"></i> Inventario</a></li>
                <li><a href="#" class="menu-item" data-view="notifications"><i class="fas fa-bell"></i> Notificaciones</a></li>
                <li class="menu-separator"></li>
                <li><a href="#" class="menu-item" data-view="server"><i class="fas fa-server"></i> Server</a></li>
                <li class="menu-separator"></li>
                <li><a href="#" class="menu-item" data-view="settings"><i class="fas fa-cog"></i> Ajustes</a></li>
            </ul>
        </nav>

        <!-- Contenido Principal -->
        <main class="content">
        <!-- Vista Dashboard -->
        <div id="dashboard-view" class="view-content active">
            <header class="header">
                <div class="header-top">
                    <div class="search-bar">
                        <input type="text" id="search-data" placeholder="Buscar en datos..." class="input-light">
                        <button class="search-btn"><i class="fas fa-search"></i></button>
                    </div>
                    
                    <div class="header-actions">
                        <button class="btn btn-primary" id="refresh-data">
                            <i class="fas fa-sync-alt"></i> Actualizar
                        </button>

                        <button id="open-filters" class="btn btn-outline" aria-haspopup="dialog" aria-controls="filters-modal">
                            <i class="fas fa-filter"></i> Filtros
                        </button>
                    </div>
                </div>
                <div class="header-main">
                    <div class="header-stats">
                        <div class="stat-card primary">
                            <i class="fas fa-chart-pie"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="total-orders">0</span>
                                <span class="stat-label">Pedidos Totales</span>
                            </div>
                            <div class="currency-panel cup">
                                <span class="stat-value" id="total-sales">$ 0</span>
                                <span class="stat-label">Ventas Totales</span>
                            </div>
                        </div>
                        <div class="stat-card accent">
                            <i class="fas fa-cubes"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="avg-order-value">$ 0</span>
                                <span class="stat-label">Valor Promedio Pedido</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-cube"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="total-products">0</span>
                                <span class="stat-label">Productos Vendidos</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <div class="stat-content">
                                <span class="stat-value" id="unique-customers">0</span>
                                <span class="stat-label">Clientes √önicos</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <i class="fas fa-user-check"></i>
                            <div class="stat-content" id="server-available-users-card">
                                <div class="metric-card small">
                                    <div class="metric-label">Visitas Totales</div>
                                    <div class="metric-value" id="server-available-users">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Filters Modal -->
                <div id="filters-modal" class="filters-modal github-save-modal" role="dialog" aria-modal="true" aria-hidden="true">
                    <div class="modal-overlay" id="filters-modal-overlay"></div>
                    <div class="modal-content" role="document">
                        <div class="modal-header">
                            <h3>Filtros</h3>
                            <button class="modal-close" id="filters-modal-close" aria-label="Cerrar filtros">&times;</button>
                        </div>
                        <div class="modal-body" style="align-items:flex-start;">
                            <div class="filters" style="display:flex; width:100%;">
                                <div class="filter-group">
                                    <label><i class="fas fa-calendar-alt"></i> Periodo</label>
                                    <select id="filter-period" class="select-light">
                                        <option value="month">Este Mes</option>
                                        <option value="last-month">Mes Pasado</option>
                                        <option value="year">Este A√±o</option>
                                        <option value="all">Todos</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label><i class="fas fa-calendar-week"></i> Rango de Fechas</label>
                                    <div class="date-range">
                                        <input type="date" id="filter-date-start" class="input-light">
                                        <span>a</span>
                                        <input type="date" id="filter-date-end" class="input-light">
                                    </div>
                                </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-globe"></i> Pa√≠s</label>
                                        <select id="filter-country" class="select-light">
                                            <option value="all">Todos</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-link"></i> Afiliado</label>
                                        <select id="filter-affiliate" class="select-light">
                                            <option value="all">Todos</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-user-tag"></i> Tipo de Usuario</label>
                                        <select id="filter-user-type" class="select-light">
                                            <option value="all">Todos</option>
                                            <option value="√önico">√önico</option>
                                            <option value="Recurrente">Recurrente</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-desktop"></i> Navegador</label>
                                        <select id="filter-browser" class="select-light">
                                            <option value="all">Todos</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-hdd"></i> Sistema Operativo</label>
                                        <select id="filter-os" class="select-light">
                                            <option value="all">Todos</option>
                                        </select>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-dollar-sign"></i> Precio Total</label>
                                        <div style="display:flex;gap:0.5rem;">
                                            <input type="number" id="filter-min-total" class="input-light" placeholder="Min">
                                            <input type="number" id="filter-max-total" class="input-light" placeholder="Max">
                                        </div>
                                    </div>
                                    <div class="filter-group">
                                        <label><i class="fas fa-shopping-bag"></i> Contiene Pedido</label>
                                        <select id="filter-has-purchase" class="select-light">
                                            <option value="all">Todos</option>
                                            <option value="with">Con Compra</option>
                                            <option value="without">Sin Compra</option>
                                        </select>
                                    </div>
                            </div>
                        </div>
                        <div class="modal-footer">
                            <button class="btn" id="filters-apply">Aplicar</button>
                            <button class="btn btn-secondary" id="filters-close">Cerrar</button>
                        </div>
                    </div>
                </div>
            </header>

            <section class="dashboard-grid">
                <div class="insights-grid">
                    <div class="card summary-card">
                        <h3 class="card-title"><i class="fas fa-chart-bar"></i> Resumen General</h3>
                        <div class="summary-grid" id="general-summary"></div>
                    </div>

                    <div class="card">
                        <h3 class="card-title"><i class="fas fa-calendar-alt"></i> Resumen Diario</h3>
                        <div class="summary-grid" id="daily-summary"></div>
                    </div>
                    
                    <div class="card full-width">
                        <h3 class="card-title"><i class="fas fa-star"></i> Top Productos</h3>
                        <div class="chart-container">
                            <canvas id="products-chart" width="300" height="200"></canvas>
                        </div>
                        <div class="ranking-list compact" id="top-products"></div>
                    </div>

                    <div class="card full-width">
                        <h3 class="card-title"><i class="fas fa-chart-line"></i> Tendencias de Ventas</h3>
                        <div class="chart-container">
                            <canvas id="sales-trend-chart" width="300" height="200"></canvas>
                        </div>
                    </div>
                    
                    <div class="card full-width" id="globe-card">
                        <h3 class="card-title"><i class="fas fa-globe"></i> Globo Interactivo de pedidos</h3>
                            <div class="chart-container" style="padding:0.5rem 1rem;">
                            <div id="globe-container"></div>
                        </div>
                    </div>
                </div>

                
            </section>
            <div class="card full-width transactions-card">
                    <div class="card-header-with-tabs">
                        <h3 class="card-title"><i class="fas fa-exchange-alt"></i> Transacciones Recientes</h3>
                        <div class="tabs">
                            <button class="tab-btn active" data-tab="all">Todos</button>
                            <button class="tab-btn" data-tab="affiliated">Con Afiliado</button>
                            <button class="tab-btn" data-tab="direct">Directos</button>
                        </div>
                    </div>
                    <div id="data-list" class="orders-container"></div>
                </div>
        </div>

        <!-- Vista Server -->
        <div id="server-view" class="view-content">
            <div class="server-header">
                <h2><i class="fas fa-server"></i> Panel de Control del Servidor</h2>
                <div class="server-controls">
                    <div class="auto-refresh-panel">
                        <label for="auto-refresh-select" class="refresh-label">
                            <i class="fas fa-sync"></i> Auto-actualizar:
                        </label>
                        <select id="auto-refresh-select" class="refresh-select">
                            <option value="0">Desactivado</option>
                            <option value="15">Cada 15s</option>
                            <option value="30">Cada 30s</option>
                            <option value="60">Cada 60s</option>
                        </select>
                        <span class="last-update" id="last-update-time">Actualizado hace poco</span>
                    </div>
                    <button class="btn btn-primary" id="refresh-server-btn">
                        <i class="fas fa-sync-alt"></i> Actualizar
                    </button>
                </div>
            </div>

            <!-- Server Grid con orden de prioridad CSS (nth-child) -->
            <div class="server-grid">
                
                <!-- 1. ESTADO DEL SERVIDOR (Priority: 1 - Full Width) -->
                <div class="server-card status-card">
                    <div class="card-header">
                        <h3><i class="fas fa-heartbeat"></i> Estado del Servidor</h3>
                    </div>
                    <div class="status-content" id="server-status-content">
                        <div class="status-item">
                            <span class="label">Estado:</span>
                            <span class="value status-running" id="server-state">Cargando...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Hora de Inicio:</span>
                            <span class="value" id="server-start-time">Cargando...</span>
                        </div>
                        <div class="status-item">
                            <span class="label">Tiempo de Actividad:</span>
                            <span class="value" id="server-uptime">Cargando...</span>
                        </div>
                    </div>
                </div>

                <!-- 2. RESUMEN DE ESTAD√çSTICAS (Priority: 2) -->
                <div class="server-card runtime-card">
                    <div class="card-header">
                        <h3><i class="fas fa-microchip"></i> Estado del Servidor (Runtime)</h3>
                    </div>
                    <div class="runtime-grid" id="server-runtime-stats">
                        <div class="stat-row">
                            <span class="label">CPU</span>
                            <span class="value" id="server-cpu">Cargando...</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">Memoria (heapUsed)</span>
                            <span class="value" id="server-memory">Cargando...</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">Cores</span>
                            <span class="value" id="server-cores">Cargando...</span>
                        </div>
                        <div class="stat-row">
                            <span class="label">Muestra CPU (ms)</span>
                            <span class="value" id="server-sample">100</span>
                        </div>
                    </div>
                </div>

                <!-- 3. PEDIDOS NUEVOS (Priority: 3 - Full Width) -->
                <div class="server-card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-boxes"></i> Pedidos Nuevos</h3>
                        <div class="card-header-actions">
                            <span class="badge" id="new-orders-count">0</span>
                            <button class="btn btn-success" id="save-orders-to-github" title="Guardar pedidos en GitHub">
                                <i class="fab fa-github"></i> Guardar en GitHub
                            </button>
                        </div>
                    </div>
                    <div class="table-responsive" id="new-orders-container">
                        <p class="no-data">Cargando pedidos...</p>
                    </div>
                </div>

                <!-- 4. LOGS DEL SERVIDOR (Priority: 4 - Full Width) -->
                <div class="server-card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-list"></i> Logs del Servidor</h3>
                        <button class="btn-icon" id="clear-logs-btn" title="Limpiar logs">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                    <div class="logs-container" id="server-logs-container">
                        <p class="no-data">Cargando logs...</p>
                    </div>
                </div>

                <!-- 5. ACTIVIDAD DE USUARIOS (Priority: 5 - Full Width) -->
                <div class="server-card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-user-circle"></i> Actividad de Usuarios</h3>
                        <div class="filter-logs">
                            <input type="text" id="filter-users" placeholder="Buscar por IP o pa√≠s..." class="input-light small">
                        </div>
                    </div>
                    <div class="table-responsive" id="users-activity-container">
                        <p class="no-data">Cargando usuarios...</p>
                    </div>
                </div>

                <!-- 6. FUENTES DE TR√ÅFICO (Priority: 6) -->
                <div class="server-card">
                    <div class="card-header">
                        <h3><i class="fas fa-globe"></i> Tr√°fico</h3>
                    </div>
                    <div class="traffic-stats" id="traffic-sources">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>

                <!-- 7. DISTRIBUCI√ìN DE PA√çSES (Priority: 7) -->
                <div class="server-card">
                    <div class="card-header">
                        <h3><i class="fas fa-map"></i> Pa√≠ses</h3>
                    </div>
                    <div class="countries-stats" id="countries-distribution">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>

                <!-- 8. NAVEGADORES Y SO (Priority: 8) -->
                <div class="server-card">
                    <div class="card-header">
                        <h3><i class="fas fa-desktop"></i> Navegadores</h3>
                    </div>
                    <div class="browser-stats" id="browser-os-stats">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>

                <!-- 9. AN√ÅLISIS DE CONVERSI√ìN (Priority: 9) -->
                <div class="server-card">
                    <div class="card-header">
                        <h3><i class="fas fa-funnel"></i> Conversi√≥n</h3>
                    </div>
                    <div class="conversion-stats" id="conversion-analytics">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>

                <!-- 10. M√âTRICAS DE RENDIMIENTO (Priority: 10 - Full Width) -->
                <div class="server-card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-tachometer-alt"></i> Rendimiento</h3>
                    </div>
                    <div class="performance-metrics" id="performance-metrics">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>

                <!-- 11. DESEMPE√ëO DE AFILIADOS (Priority: 11 - Full Width) -->
                <div class="server-card full-width">
                    <div class="card-header">
                        <h3><i class="fas fa-link"></i> Afiliados</h3>
                    </div>
                    <div class="table-responsive" id="affiliate-performance">
                        <p class="no-data">Cargando...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Inventario -->
        <div id="inventory-view" class="view-content"></div>

        <!-- Vista Pedidos -->
        <div id="pedidos-view" class="view-content">
            <div class="pedidos-header">
                <h2><i class="fas fa-shopping-cart"></i> Administraci√≥n de Pedidos</h2>
                <div class="pedidos-controls">
                    <div class="auto-refresh-panel-pedidos">
                        <label for="auto-refresh-pedidos-select" class="refresh-label">
                            <i class="fas fa-sync"></i> Auto-actualizar:
                        </label>
                        <select id="auto-refresh-pedidos-select" class="refresh-select">
                            <option value="0">Desactivado</option>
                            <option value="10000">Cada 10s</option>
                            <option value="20000">Cada 20s</option>
                            <option value="30000">Cada 30s</option>
                            <option value="60000">Cada 60s</option>
                        </select>
                        <span class="last-update-pedidos" id="last-update-pedidos">Actualizado hace poco</span>
                    </div>
                    <button class="btn btn-primary" id="refresh-pedidos-btn">
                        <i class="fas fa-sync-alt"></i> Actualizar Ahora
                    </button>
                </div>
            </div>

            <div class="pedidos-container" id="pedidos-container">
                <div class="pedidos-stats">
                    <div class="stat-item">
                        <i class="fas fa-shopping-bag"></i>
                        <div class="stat-content">
                            <span class="stat-label">Pedidos Pendientes</span>
                            <span class="stat-value" id="pedidos-count">0</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-dollar-sign"></i>
                        <div class="stat-content">
                            <span class="stat-label">Total de Ventas</span>
                            <span class="stat-value" id="pedidos-total">$0.00</span>
                        </div>
                    </div>
                    <div class="stat-item">
                        <i class="fas fa-box"></i>
                        <div class="stat-content">
                            <span class="stat-label">Productos</span>
                            <span class="stat-value" id="pedidos-productos">0</span>
                        </div>
                    </div>
                </div>

                <div class="pedidos-info-notice">
                    <i class="fas fa-info-circle"></i>
                    <span>Cada tarjeta representa un pedido completo. Presiona "Entregar" para marcar como entregado.</span>
                </div>

                <div id="pedidos-lista" class="pedidos-lista">
                    <div class="no-pedidos">
                        <i class="fas fa-inbox"></i>
                        <p>No hay pedidos pendientes</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Notificaciones - Editor -->
        <div id="notifications-view" class="view-content">
            <div class="notifications-header">
                <h2><i class="fas fa-bell"></i> Editor de Notificaciones</h2>
                <p class="notifications-subtitle">Edita y personaliza las notificaciones de la tienda Buquenque</p>
            </div>

            <div class="notifications-container">
                <div class="editor-wrapper">
                    <!-- Panel de Edici√≥n -->
                    <div class="editor-panel">
                        <div class="editor-card">
                            <div class="card-header">
                                <h3><i class="fas fa-pen-square"></i> Formulario de Notificaci√≥n</h3>
                            </div>

                            <form class="editor-form" id="notification-editor-form">
                                <!-- ID Display -->
                                <div class="form-group id-group">
                                    <label>ID de Notificaci√≥n</label>
                                    <div class="id-display-wrapper">
                                        <div class="id-badge" id="notification-id-display">1</div>
                                        <button type="button" class="btn btn-secondary" id="generate-notification-id">
                                            <i class="fas fa-dice"></i> Generar Nuevo
                                        </button>
                                    </div>
                                    <p class="input-help">Se genera autom√°ticamente entre 1-3 para evitar repeticiones</p>
                                </div>

                                <!-- T√≠tulo -->
                                <div class="form-group">
                                    <label for="notification-title">
                                        <i class="fas fa-heading"></i> T√≠tulo (Requerido)
                                    </label>
                                    <input 
                                        type="text" 
                                        id="notification-title" 
                                        placeholder="Ej: ¬°Bienvenido a Buquenque Shop!" 
                                        class="input-light"
                                        maxlength="100"
                                        required
                                    >
                                    <p class="input-help">M√°ximo 100 caracteres</p>
                                </div>

                                <!-- Mensaje -->
                                <div class="form-group">
                                    <label for="notification-message">
                                        <i class="fas fa-comment-dots"></i> Mensaje (Requerido)
                                    </label>
                                    <textarea 
                                        id="notification-message" 
                                        placeholder="Ej: Descubre nuestras ofertas especiales..." 
                                        class="input-light textarea-light"
                                        maxlength="500"
                                        rows="4"
                                        required
                                    ></textarea>
                                    <p class="input-help">M√°ximo 500 caracteres</p>
                                </div>

                                <!-- Subt√≠tulo -->
                                <div class="form-group">
                                    <label for="notification-subtitle">
                                        <i class="fas fa-feather"></i> Subt√≠tulo (Opcional)
                                    </label>
                                    <input 
                                        type="text" 
                                        id="notification-subtitle" 
                                        placeholder="Ej: Oferta v√°lida hasta el 31 de enero" 
                                        class="input-light"
                                        maxlength="150"
                                    >
                                    <p class="input-help">M√°ximo 150 caracteres</p>
                                </div>

                                <!-- Tipo de Notificaci√≥n -->
                                <div class="form-group">
                                    <label for="notification-type">
                                        <i class="fas fa-tag"></i> Tipo de Notificaci√≥n
                                    </label>
                                    <select id="notification-type" class="select-light">
                                        <option value="info">‚ÑπÔ∏è Informaci√≥n</option>
                                        <option value="success">‚úÖ √âxito</option>
                                        <option value="warning">‚ö†Ô∏è Advertencia</option>
                                        <option value="error">‚ùå Error</option>
                                        <option value="promo">üéÅ Promoci√≥n</option>
                                    </select>
                                </div>

                                <!-- Icono -->
                                <div class="form-group">
                                    <label>
                                        <i class="fas fa-icons"></i> Icono de Notificaci√≥n
                                    </label>
                                    <div class="icon-display-wrapper">
                                        <div class="icon-display" id="current-icon-display">
                                            <i class="fas fa-bell"></i>
                                        </div>
                                        <button type="button" class="btn btn-secondary" id="notification-icon-btn">
                                            <i class="fas fa-search"></i> Seleccionar Icono
                                        </button>
                                    </div>
                                    <p class="input-help">Font Awesome 6 - Haz clic para seleccionar</p>
                                </div>

                                <!-- Status Message -->
                                <div class="notification-editor-status" id="notification-editor-status" style="display: none;"></div>

                                <!-- Botones de Acci√≥n -->
                                <div class="form-actions">
                                    <button type="button" class="btn btn-primary" id="save-notification-btn">
                                        <i class="fas fa-save"></i> Guardar Notificaci√≥n
                                    </button>
                                    <button type="button" class="btn btn-secondary" id="reset-notification-btn">
                                        <i class="fas fa-undo"></i> Recargar Datos
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>

                    <!-- Panel de Vista Previa -->
                    <div class="preview-panel">
                        <div class="preview-card">
                            <div class="card-header">
                                <h3><i class="fas fa-eye"></i> Vista Previa en Tiempo Real</h3>
                            </div>

                            <div class="preview-content" id="notification-preview-container">
                                <!-- La notificaci√≥n se renderiza aqu√≠ -->
                                <div id="preview-notification-banner" class="notification-banner">
                                    <!-- Se llena con updatePreview() -->
                                </div>
                            </div>

                            <div class="preview-info">
                                <p class="preview-note">
                                    <i class="fas fa-info-circle"></i>
                                    Este es el preview de c√≥mo se ver√° la notificaci√≥n cuando se publique. Los cambios se actualizan en tiempo real.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Modal Selector de Iconos -->
            <div class="icon-selector-modal" id="icon-selector-modal">
                <div class="icon-selector-overlay" id="icon-selector-overlay"></div>
                <div class="icon-selector-content">
                    <div class="modal-header">
                        <h3>Seleccionar Icono</h3>
                        <button class="modal-close" id="icon-selector-close" type="button">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="icon-search-wrapper">
                            <input 
                                type="text" 
                                id="icon-search" 
                                placeholder="Buscar icono (ej: gift, star, heart)..." 
                                class="input-light"
                            >
                            <i class="fas fa-search search-icon"></i>
                        </div>
                        <div class="icons-grid" id="icons-grid">
                            <!-- Los iconos se generan din√°micamente -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Vista Settings -->
        <div id="settings-view" class="view-content">
            <div class="settings-header">
                <h2><i class="fas fa-cog"></i> Ajustes</h2>
            </div>
            
            <div class="settings-container">
                <!-- GitHub Integration Section -->
                <div class="settings-card">
                    <div class="card-header">
                        <h3><i class="fab fa-github"></i> Integraci√≥n de GitHub</h3>
                        <p class="card-description">Configura tu token de GitHub para guardar datos en tus repositorios</p>
                    </div>
                    
                    <div class="settings-form">
                        <div class="form-group">
                            <label for="github-token-input">Token de GitHub</label>
                            <div class="token-input-wrapper">
                                <input 
                                    type="password" 
                                    id="github-token-input" 
                                    placeholder="ghp_xxxxxxxxxxxxxxxxxxxxxxxxxxxx"
                                    class="input-light token-input"
                                >
                                <button class="btn-toggle-token" id="toggle-token-visibility" title="Mostrar/Ocultar token">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            <p class="input-help">
                                <i class="fas fa-info-circle"></i>
                                Tu token se almacena localmente en el navegador por tanto evita darle el telefono a alguien mas que pueda entrar aqui.
                            </p>
                        </div>

                        <div class="form-group info-group">
                            <h4>Configuraci√≥n Fija</h4>
                            <div class="config-display">
                                <div class="config-item">
                                    <span class="label">Repositorio:</span>
                                    <span class="value" id="config-repo">HCoreBeat/Analytics-Buquenque</span>
                                </div>
                                <div class="config-item">
                                    <span class="label">Ruta del Archivo:</span>
                                    <span class="value" id="config-file-path">Json/my_data.json</span>
                                </div>
                            </div>
                            <p class="input-help">
                                <i class="fas fa-lock"></i>
                                Estos valores est√°n predefinidos y no pueden ser cambiados
                            </p>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary" id="save-github-settings">
                                <i class="fas fa-save"></i> Guardar Token
                            </button>
                            <button class="btn btn-secondary" id="test-github-connection">
                                <i class="fas fa-plug"></i> Probar Conexi√≥n
                            </button>
                            <button class="btn btn-danger" id="clear-github-settings">
                                <i class="fas fa-trash"></i> Limpiar Token
                            </button>
                        </div>

                        <div class="settings-status" id="github-settings-status" style="display: none;"></div>
                    </div>
                </div>

                <!-- Other Settings -->
                <div class="settings-card">
                    <div class="card-header">
                        <h3><i class="fas fa-sliders-h"></i> Preferencias Generales</h3>
                    </div>
                    
                    <div class="settings-form">
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="auto-save-enabled" class="checkbox">
                                Guardar autom√°ticamente pedidos
                            </label>
                            <p class="input-help">
                                Los pedidos se guardar√°n autom√°ticamente en GitHub seg√∫n la frecuencia seleccionada
                            </p>
                        </div>

                        <div class="form-group">
                            <label for="auto-save-interval">Intervalo de Auto-guardado</label>
                            <select id="auto-save-interval" class="select-light">
                                <option value="5">Cada 5 minutos</option>
                                <option value="10">Cada 10 minutos</option>
                                <option value="30">Cada 30 minutos</option>
                                <option value="60">Cada 1 hora</option>
                            </select>
                        </div>

                        <div class="form-actions">
                            <button class="btn btn-primary" id="save-preferences">
                                <i class="fas fa-save"></i> Guardar Preferencias
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    </div>

    <footer class="app-footer">
        <div class="footer-content">
            <span>&copy; 2026 Buquenque Dashboard. Todos los derechos reservados HLab</span>
            <span class="footer-version">Versi√≥n 2.1.1</span>
        </div>
    </footer>

    <!-- Modal de Guardado en GitHub -->
    <div class="github-save-modal" id="github-save-modal">
        <div class="modal-overlay" id="modal-overlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">Guardando pedidos...</h3>
                <button class="modal-close" id="modal-close-btn" aria-label="Cerrar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="modal-icon" id="modal-icon">
                    <i class="fas fa-spinner fa-spin"></i>
                </div>
                <div class="modal-message" id="modal-message">
                    <p class="status-text" id="status-text">Conectando con GitHub...</p>
                    <p class="detail-text" id="detail-text">Por favor espera</p>
                </div>
                <div class="modal-progress" id="modal-progress" style="display: none;">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <p class="progress-text" id="progress-text">0%</p>
                </div>
            </div>
            <div class="modal-footer" id="modal-footer">
                <button class="btn btn-primary" id="modal-retry-btn" style="display: none;">
                    <i class="fas fa-redo"></i> Reintentar
                </button>
                <button class="btn btn-secondary" id="modal-close-final-btn" style="display: none;">
                    Cerrar
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script type="module" src="Js/script-new.js" defer></script>
    <script type="module" src="Js/server-panel.js" defer></script>
    <script type="module" src="Js/pedidos.js" defer></script>
    <script type="module" src="Js/globe.js" defer></script>
</body>
</html>
